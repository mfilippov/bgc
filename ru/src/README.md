# Исходный Markdown Beej's Guide

## Расширения Beej для Markdown

Их обрабатывает скрипт `bin/preproc`.

* `[[pagebreak]]`

  Вставляет разрыв страницы в печатной версии. Преобразуется в LaTeX-команду
  `\newpage`.

* `[nh[word]]`

  Запрещает перенос слова. Превращается в
  `\hyphenation{word}`. Символ подчёркивания запрещён из-за ограничений LaTeX.

* `[ix[entry]]`

  Создаёт индексную запись LaTeX, подставляя её как есть в `\index{}`.
  **Не забудьте экранировать подчёркивания с помощью `\_`!**
  [Примеры индексирования в LaTeX](https://en.wikibooks.org/wiki/LaTeX/Indexing#Sophisticated_indexing).

* `[ixtt[entry]]`

  Для одной простой записи индекса выводит моноширинный текст в виде
  `\index{entry@\texttt{entry}}`. Более сложные записи оформляйте через
  чистый LaTeX в `[ix[]]`.

* `[fl[linktext|url]]`

  Сноска-ссылка. Гиперссылка на `url` с текстом `linktext`, при этом URL
  показывается в сноске. Преобразуется в `[linktext](url)^[url]`.
    
* `[flx[linktext|file]]`

  Сноска-ссылка на примеры Beej. Автоматически добавляет префикс
  `https://beej.us/guide/bgnet/examples/` и выводит URL в сноске.

* `[flr[link|id]]`

   Сноска-ссылка на редирект Beej. Автоматически добавляет
   `https://beej.us/guide/url/` перед идентификатором и показывает URL в сноске.

* `[flrfc[link|num]]`

   Сноска-ссылка на RFC. Автоматически добавляет
   `https://tools.ietf.org/html/rfc` перед номером и показывает URL в сноске.
   

## Особенности markdown в pandoc

Если у вас несколько встроенных сносок в одном абзаце, но на разных
строках, все строки, кроме последней, должны заканчиваться пробелом.

Подразделы man-страниц---это заголовки h4 `####`, чтобы они не попадали
в оглавление. В Pandoc 2.8 появится способ исключать из оглавления h3.

Строки таблиц должны быть на одной строке для корректного переноса (символы
перевода строки внутри ячеек сохраняются).

Таблицы: итоговая ширина столбцов соответствует относительной ширине заголовков.

Шаблон заголовка таблицы:

```
| Macro           | Description                                            |
|-----------------|--------------------------------------------------------|
```

`<a name>` не работает. Используйте заголовки с `{#tags}`.

Ограждённые блоки кода со стандартным именем языка иногда заставляют LaTeX ругаться.

````
```c                   Так делать не стоит

``` {.c}               Делайте так
``` {.c .numberLines}  Или так
````

Индекс строится маркерами LaTeX `\index{foo}`. В HTML они не отображаются.

Примеры индексирования в LaTeX:

(Подчёркивания экранируйте `\_`!)

```latex
\index{foo} plain element
\index{foo\_bar} element with underscore
\index{foo()@\texttt{foo()}} render foo() in monospace in index
\index{O\_NONBLOCK@\texttt{O\_NONBLOCK}} mono with underscores
\index{foo!bar} subindex bar in foo
\index{bind()@\texttt{bind()}!implicit} subindex with mono
```

[Больше примеров индексирования в LaTeX](https://en.wikibooks.org/wiki/LaTeX/Indexing#Sophisticated_indexing).

Индексные записи должны идти на верхнем уровне и не находиться в заголовках,
жирном или курсивном тексте (иначе появятся отдельные записи в индексе).

Перед каждой man-страницей ставьте `\newpage`, чтобы принудительно сделать разрыв.

При правке `bgnet_amazon.md` используйте `\newpage`, для корректного
размещения текста и предотвращения появления висячих строк в конце страницы.

Сноски после ссылок на соседних строках требуют пробела в конце строки, чтобы
работать корректно...

```markdown
[Hey](url)^[footnote],   <-- В конце строки нужен пробел
[Again](url2)^[footnote2].
```
